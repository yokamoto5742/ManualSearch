# ManualSearch Code Explanation

このドキュメントは、マニュアル検索アプリのコード解説です。主要なクラスと関数の概要を説明します。

## 主要なクラス

### ConfigManager

設定の管理を担当するクラスです。

主な機能：
- 設定ファイルの読み込みと保存
- ファイル拡張子、ウィンドウジオメトリ、フォントサイズなどの設定の取得と設定
- ディレクトリリストの管理

主なメソッド：
- `load_config()`: 設定ファイルを読み込む
- `save_config()`: 設定をファイルに保存する
- `get_file_extensions()`, `set_file_extensions()`: ファイル拡張子の取得と設定
- `get_window_geometry()`, `set_window_geometry()`: ウィンドウジオメトリの取得と設定
- `get_directories()`, `set_directories()`: ディレクトリリストの取得と設定

### AutoCloseMessage

自動的に閉じるメッセージウィンドウを表示するクラスです。

主な機能：
- 指定された時間後に自動的に閉じるメッセージウィンドウの表示

主なメソッド：
- `show_message(message, duration)`: メッセージを表示し、指定された時間後に閉じる

### FileSearcher

ファイル検索を行うクラスです。QThreadを継承しており、バックグラウンドで検索を実行します。

主な機能：
- 指定されたディレクトリ内のファイルを検索
- PDFとテキストファイルの内容を検索
- 検索結果を発見時にシグナルで通知

主なメソッド：
- `run()`: 検索処理を実行
- `search_file()`: 個々のファイルを検索
- `search_pdf()`: PDFファイルの検索
- `search_text()`: テキストファイルの検索

### MainWindow

アプリケーションのメインウィンドウを表すクラスです。

主な機能：
- ユーザーインターフェースの構築と管理
- 検索処理の開始と結果の表示
- ファイルの開封と強調表示

主なメソッド：
- `start_search()`: 検索を開始
- `add_result()`: 検索結果をリストに追加
- `show_result()`: 選択された結果の詳細を表示
- `open_file()`: 選択されたファイルを開く
- `highlight_pdf()`, `highlight_text_file()`: PDFとテキストファイルの内容を強調表示

## 主要な関数

### is_network_file(file_path)

ファイルパスがネットワーク上のファイルを指しているかどうかを判断します。

### check_file_accessibility(file_path, timeout=5)

ファイルにアクセス可能かどうかを確認します。ネットワークファイルの場合はタイムアウトを設定します。

## その他の重要な点

- このアプリケーションは PyQt5 を使用してGUIを構築しています。
- PDFの処理には PyPDF2 と PyMuPDF (fitz) ライブラリを使用しています。
- マークダウンファイルの処理には markdown ライブラリを使用しています。
- 設定の保存には configparser を使用しています。
- ファイル操作や文字列処理には標準ライブラリの os, re, tempfile などを使用しています。

このアプリケーションは、複数のファイル形式（PDF、テキスト、マークダウン）に対応した柔軟な検索機能を提供し、検索結果の強調表示や該当ページへの移動など、ユーザーフレンドリーな機能を実装しています。
